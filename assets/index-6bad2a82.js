import{M as x,d as Q,a as c,r as W,J as X,b as n,o as k,c as h,e as l,w as r,h as U,f as s,m as Y,N,x as Z,F as ee,B as T,O as g,_ as ae}from"./index-812eb3fc.js";const le=(d,i)=>x.get(`admin/product/baseTrademark/${d}/${i}`),te=d=>d.id?x.put("admin/product/baseTrademark/update",d):x.post("admin/product/baseTrademark/save",d),oe=d=>x.delete(`admin/product/baseTrademark/remove/${d}`),re=["src"],ne=["src"],se=Q({__name:"index",setup(d){let i=c(1),_=c(3),C=c(0),b=c(),m=c(!1),y=c("添加品牌"),o=c({tmName:"",logoUrl:""}),p=c();const z=W({tmName:[{required:!0,validator:(a,e,u)=>{e.trim().length>=2?u():u(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,validator:(a,e,u)=>{e?u():u(new Error("LOGO图片务必上传"))}}]}),P=()=>{y.value="添加品牌",m.value=!0,o.value.tmName="",o.value.logoUrl="",o.value.id=void 0,T(()=>{p.value.clearValidate("logotmNameUrl"),p.value.clearValidate("logoUrl")})},q=a=>{y.value="修改品牌",m.value=!0,T(()=>{p.value.clearValidate("logotmNameUrl"),p.value.clearValidate("logoUrl")}),o.value.tmName=a.tmName,o.value.logoUrl=a.logoUrl},w=async a=>{let e=await oe(a.id);e.code==200?(g.success(a.tmName+"删除成功"),f(b.value.length>1?i.value:i.value-1)):g.error(e.message)},f=async(a=1)=>{i.value=a;let e=await le(i.value,_.value);e.code==200&&(C.value=e.data.total,b.value=e.data.records)},O=a=>{_.value=a,f()};X(()=>{f()});const E=(a,e)=>{o.value.logoUrl=a.data,p.value.clearValidate("logoUrl")},F=a=>a.type=="image/jpeg"||a.type=="image/png"||a.type=="image/gif"?a.size/1024/1024>4?(g.error("上传文件大小限制4M"),!1):!0:(g.error("上传文件格式:PNG/JPG/GIF"),!1),G=()=>{m.value=!1},S=async()=>{await p.value.validate();let a=await te(o.value);m.value=!1,a.code==200?(g.success(o.value.id?"品牌修改成功":"品牌添加成功"),f(o.value.id?i.value:1)):g.success(o.value.id?"品牌修改失败":"品牌添加失败")};return(a,e)=>{const u=n("el-button"),v=n("el-table-column"),$=n("el-popconfirm"),L=n("el-table"),M=n("el-pagination"),A=n("el-card"),B=n("el-input"),V=n("el-form-item"),D=n("Plus"),R=n("el-icon"),j=n("el-upload"),I=n("el-form"),J=n("el-dialog");return k(),h(ee,null,[l(A,{class:"box-card"},{default:r(()=>[l(u,{type:"primary",size:"default",icon:"Plus",onClick:P},{default:r(()=>[U("添加品牌")]),_:1}),l(L,{data:s(b),border:"",stripe:"",style:{"margin-top":"20px","margin-bottom":"20px"},"max-height":"600px"},{default:r(()=>[l(v,{label:"序号",width:"80px",align:"center",type:"index"}),l(v,{label:"品牌名称",align:"center",prop:"tmName"}),l(v,{label:"品牌logo",align:"center"},{default:r(({row:t,$index:H})=>[Y("img",{src:t.logoUrl,alt:"",style:{width:"100px",height:"100px"}},null,8,re)]),_:1}),l(v,{label:"品牌操作",align:"center"},{default:r(({row:t,$index:H})=>[l(u,{type:"primary",size:"small",onClick:K=>q(t),icon:"Edit"},null,8,["onClick"]),l($,{title:`你确认删除${t.tmName}品牌吗?`,onConfirm:K=>w(t),icon:"Delete",width:"200px"},{reference:r(()=>[l(u,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),l(M,{"current-page":s(i),"onUpdate:currentPage":e[0]||(e[0]=t=>N(i)?i.value=t:i=t),"page-size":s(_),"onUpdate:pageSize":e[1]||(e[1]=t=>N(_)?_.value=t:_=t),"page-sizes":[3,5,10,15],small:!0,background:!0,layout:"prev, pager, next, jumper,->,sizes,total",total:s(C),onSizeChange:O,onCurrentChange:f},null,8,["current-page","page-size","total"])]),_:1}),l(J,{title:s(y),visible:111,onClose:e[3]||(e[3]=()=>{}),modelValue:s(m),"onUpdate:modelValue":e[4]||(e[4]=t=>N(m)?m.value=t:m=t)},{footer:r(()=>[l(u,{onClick:G},{default:r(()=>[U("取消")]),_:1}),l(u,{type:"primary",onClick:S},{default:r(()=>[U("确定")]),_:1})]),default:r(()=>[l(I,{ref_key:"ruleFormRef",ref:p,"label-width":"80px",inline:!1,size:"default",model:s(o),rules:s(z)},{default:r(()=>[l(V,{label:"品牌名称",prop:"tmName"},{default:r(()=>[l(B,{placeholder:"请输入品牌名称",modelValue:s(o).tmName,"onUpdate:modelValue":e[2]||(e[2]=t=>s(o).tmName=t)},null,8,["modelValue"])]),_:1}),l(V,{label:"品牌LOGO",prop:"logoUrl"},{default:r(()=>[l(j,{class:"avatar-uploader",action:"http://sph-api.atguigu.cn/admin/product/fileUpload","show-file-list":!1,"on-success":E,"before-upload":F},{default:r(()=>[s(o).logoUrl?(k(),h("img",{key:0,src:s(o).logoUrl,class:"avatar"},null,8,ne)):(k(),Z(R,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[l(D)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])],64)}}});const me=ae(se,[["__scopeId","data-v-3460f26f"]]);export{me as default};
