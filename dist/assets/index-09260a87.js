import{d as K,L as R,r as g,v as G,M as H,c,o as p,e as V,f as e,g as s,y as x,z as A,w as a,h as f,F as Q,l as W,j as I,m as w,t as z,N as X,O as Y,K as y,x as S,P as Z,_ as ee}from"./index-83aa274e.js";const le=["onClick"],ae=K({__name:"index",setup(te){let u=R(),o=g({id:void 0,attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),n=g(!1),b=g([]),v=g([]);G(()=>u.c3Id,()=>{u.c3Id?h():b.value=[]});const h=()=>{X(u.c1Id,u.c2Id,u.c3Id).then(l=>{console.log(l),l.code==200&&(b.value=l.data)})},B=l=>{console.log(l),n.value=!n.value,Object.assign(o.value,JSON.parse(JSON.stringify(l)))},D=l=>{Y(l.id).then(r=>{console.log(r),r.code==200?(y({type:"success",message:"删除成功"}),h()):y({type:"error",message:"删除失败"})})},E=()=>{console.log("添加平台属性"),o.value={id:void 0,attrName:"",attrValueList:[],categoryId:u.c3Id,categoryLevel:3},n.value=!n.value},T=()=>{console.log("添加属性值"),o.value.attrValueList.push({valueName:"",flag:!0}),S(()=>{v.value[v.value.length-1].focus()})},O=()=>{console.log("取消添加属性值"),n.value=!n.value},P=()=>{console.log("保存"),Z(o.value).then(l=>{console.log(l),l.code==200&&(n.value=!n.value,h())})},U=()=>{console.log("取消保存"),n.value=!n.value},q=(l,r)=>{l.flag=!0,S(()=>{v.value[r].focus()})},$=(l,r)=>{if(l.valueName.trim()==""){o.value.attrValueList.splice(r,1),y({type:"error",message:"属性值不能为空"});return}if(o.value.attrValueList.find(d=>{if(d!=l)return d.valueName===l.valueName})){o.value.attrValueList.splice(r,1),y({type:"error",message:"属性值不能重复"});return}l.flag=!1};return H(()=>{u.$reset()}),(l,r)=>{const C=c("Category"),d=c("el-button"),m=c("el-table-column"),j=c("el-tag"),F=c("el-popconfirm"),N=c("el-table"),k=c("el-card"),L=c("el-input"),J=c("el-form-item"),M=c("el-form");return p(),V("div",null,[e(C,{disabled:s(n)},null,8,["disabled"]),x(e(k,{class:"bottom_card",shadow:"always"},{default:a(()=>[e(d,{type:"primary",size:"small",onClick:E,icon:"Plus",disabled:!s(u).c3Id},{default:a(()=>[f(" 添加平台属性 ")]),_:1},8,["disabled"]),e(N,{data:s(b),border:"",style:{width:"100%"}},{default:a(()=>[e(m,{type:"index",label:"序号",width:"80px",align:"center"}),e(m,{prop:"attrName",label:"属性名称",width:"160px"}),e(m,{label:"属性值名称"},{default:a(({row:t})=>[(p(!0),V(Q,null,W(t.attrValueList,(i,_)=>(p(),w(j,{key:_},{default:a(()=>[f(z(i.valueName),1)]),_:2},1024))),128))]),_:1}),e(m,{label:"操作",width:"160px"},{default:a(t=>[e(d,{type:"warning",size:"small",onClick:i=>B(t.row),icon:"Edit"},null,8,["onClick"]),e(F,{title:"确定要删除该品牌吗?",onConfirm:i=>D(t.row)},{reference:a(()=>[e(d,{size:"small",type:"danger",icon:"Delete"})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1},512),[[A,!s(n)]]),x(e(k,{class:"bottom_card",shadow:"always"},{default:a(()=>[e(M,{ref:"formRefAdd",inline:!0,class:"formAdd"},{default:a(()=>[e(J,{label:"属性名称"},{default:a(()=>[e(L,{modelValue:s(o).attrName,"onUpdate:modelValue":r[0]||(r[0]=t=>s(o).attrName=t),placeholder:"请您输入属性的名字",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},512),I("div",null,[e(d,{type:"primary",size:"small",onClick:T,icon:"Plus",disabled:!s(o).attrName},{default:a(()=>[f(" 添加属性值 ")]),_:1},8,["disabled"]),e(d,{type:"default",size:"small",onClick:O},{default:a(()=>[f(" 取消 ")]),_:1})]),e(N,{data:s(o).attrValueList,border:"",style:{width:"100%"}},{default:a(()=>[e(m,{type:"index",label:"序号",width:"80px",align:"center"}),e(m,{label:"属性值"},{default:a(({row:t,$index:i})=>[t.flag?(p(),w(L,{key:0,ref:_=>s(v)[i]=_,placeholder:"请您输入属性值名称",modelValue:t.valueName,"onUpdate:modelValue":_=>t.valueName=_,onBlur:_=>$(t,i)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(p(),V("div",{key:1,onClick:_=>q(t,i)},z(t.valueName),9,le))]),_:1}),e(m,{label:"操作"},{default:a(({$index:t})=>[e(d,{size:"small",type:"danger",icon:"Delete",onClick:i=>s(o).attrValueList.splice(t,1)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),I("div",null,[e(d,{type:"primary",size:"small",onClick:P,disabled:!(s(o).attrValueList.length&&s(o).attrName)},{default:a(()=>[f(" 保存 ")]),_:1},8,["disabled"]),e(d,{type:"default",size:"small",onClick:U},{default:a(()=>[f(" 取消 ")]),_:1})])]),_:1},512),[[A,s(n)]])])}}});const ne=ee(ae,[["__scopeId","data-v-ba403320"]]);export{ne as default};
