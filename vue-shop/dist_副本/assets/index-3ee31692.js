import{M as k,d as j,a as i,J as T,A as P,b as u,o as c,c as b,e,w as a,x as N,n as U,h as L,f as s,O as o,N as M,F as A,v as S,t as Y}from"./index-812eb3fc.js";const Z=()=>k.get("/admin/product/getCategory1"),ee=n=>k.get(`/admin/product/getCategory2/${n}`),te=n=>k.get(`/admin/product/getCategory3/${n}`),ae=(n,C,d)=>k.get(`/admin/product/attrInfoList/${n}/${C}/${d}`),le=n=>k.delete(`/admin/product/deleteAttr/${n}`),re=n=>k.post("/admin/product/saveAttrInfo",n),oe={key:0},ne={attrName:"AddAttr"},de=j({...ne,__name:"index",props:{attr:{type:Object}},emits:["cancel","update"],setup(n,{emit:C}){const d=n;let h=i(!0),_=i(!0);T(()=>{P(d.attr,()=>{h.value=d.attr.attrName.length==0}),P(d.attr,()=>{_.value=d.attr.attrValueList.length<1||h.value})});const x=()=>{let g={};d.attr.attrValueList.push(g)},p=(g,y)=>{d.attr.attrValueList.splice(y,1)},V=async()=>{try{(await re(d.attr)).code==200?(C("update"),o.success("属性保存成功")):o.error("属性保存失败")}catch{o.error("属性保存失败")}},w=()=>{C("cancel")};return(g,y)=>{const m=u("el-input"),I=u("el-form-item"),J=u("el-form"),f=u("el-button"),$=u("el-table-column"),z=u("el-table");return c(),b("div",null,[e(J,{ref:"ruleFormRef","label-width":"80px",inline:!0,size:"default"},{default:a(()=>[n.attr?(c(),N(I,{key:0,label:"属性名称",prop:"tmName"},{default:a(()=>[e(m,{placeholder:"请输入属性名称",modelValue:n.attr.attrName,"onUpdate:modelValue":y[0]||(y[0]=v=>n.attr.attrName=v)},null,8,["modelValue"])]),_:1})):U("",!0)]),_:1},512),e(f,{type:"primary",size:"default",onClick:x,icon:"Plus",disabled:s(h)},{default:a(()=>[L("添加属性值")]),_:1},8,["disabled"]),n.attr?(c(),b("div",oe,[e(z,{data:n.attr.attrValueList,border:"",stripe:"",style:{"margin-top":"20px","margin-bottom":"20px"},"max-height":"600px"},{default:a(()=>[e($,{label:"序号",width:"80px",align:"center",type:"index"}),e($,{label:"属性值名称",align:"center"},{default:a(({row:v,$index:q})=>[e(m,{modelValue:v.valueName,"onUpdate:modelValue":l=>v.valueName=l,placeholder:"请输入属性值名称",size:"normal",clearable:"",onChange:y[1]||(y[1]=()=>{})},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e($,{label:"属性值操作",align:"center"},{default:a(({row:v,$index:q})=>[e(f,{type:"primary",size:"small",icon:"Delete",onClick:l=>p(v,q)},null,8,["onClick"])]),_:1})]),_:1},8,["data"])])):U("",!0),e(f,{type:"primary",size:"default",onClick:V,disabled:s(_)},{default:a(()=>[L("保存")]),_:1},8,["disabled"]),e(f,{type:"primary",size:"default",onClick:w},{default:a(()=>[L("取消")]),_:1})])}}}),se={key:0},ie=j({__name:"index",setup(n){i([{id:1,label:"1111"},{id:2,label:"2222"},{id:3,label:"3333"},{id:4,label:"4444"}]);let C=i([]),d=i(),h=i([]),_=i(),x=i([]),p=i(),V=i([]),w=i(),g=i(""),y=i(!1),m=i(!1);T(async()=>{P([d,_,p],(l,r)=>{y.value=!(d.value==null||_.value==null||p.value==null)});try{let l=await Z();C.value=l.data,l.code==200?o.success("一级分类数据获取成功"):o.error("一级分类数据获取失败")}catch{o.error("一级分类数据获取失败")}});const I=async l=>{try{_.value=void 0,p.value=void 0,h.value.length=0,x.value.length=0,V.value.length=0;let r=await ee(l);h.value=r.data,r.code==200?o.success("二级分类数据获取成功"):o.error("二分类数据获取失败")}catch{o.error("二分类数据获取失败")}},J=async l=>{try{p.value=void 0,x.value.length=0,V.value.length=0;let r=await te(l);x.value=r.data,r.code==200?o.success("三分类数据获取成功"):o.error("三分类数据获取失败")}catch{o.error("三分类数据获取失败")}},f=async()=>{try{V.value.length=0;let l=await ae(d.value,_.value,p.value);V.value=l.data,l.code==200?o.success("商品属性获取成功"):o.error("商品属性获取失败")}catch{o.error("商品属性获取失败")}},$=async l=>{try{(await le(l.id)).code==200?(o.success("属性删除成功"),f()):o.error("属性删除失败")}catch{o.error("属性删除失败")}},z=(l={})=>{if(m.value=!0,l.id==null){let r={attrValueList:[],attrName:"",categoryId:p.value,categoryLevel:3};l.attrName=g.value,w.value=JSON.parse(JSON.stringify(r))}else w.value=JSON.parse(JSON.stringify(l))},v=()=>{m.value=!m},q=()=>{m.value=!m,f()};return(l,r)=>{const E=u("el-option"),G=u("el-select"),B=u("el-form-item"),H=u("el-form"),R=u("el-card"),F=u("el-button"),D=u("el-table-column"),K=u("el-tag"),Q=u("el-popconfirm"),W=u("el-table");return c(),b(A,null,[e(R,{shadow:"always","body-style":{padding:"20px"}},{default:a(()=>[e(H,{inline:!0},{default:a(()=>[e(B,{label:"一级分类"},{default:a(()=>[e(G,{modelValue:s(d),"onUpdate:modelValue":r[0]||(r[0]=t=>M(d)?d.value=t:d=t),onChange:I,disabled:s(m)},{default:a(()=>[(c(!0),b(A,null,S(s(C),t=>(c(),N(E,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(B,{label:"二级分类"},{default:a(()=>[e(G,{modelValue:s(_),"onUpdate:modelValue":r[1]||(r[1]=t=>M(_)?_.value=t:_=t),onChange:J,disabled:s(m)},{default:a(()=>[(c(!0),b(A,null,S(s(h),t=>(c(),N(E,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),e(B,{label:"三级分类"},{default:a(()=>[e(G,{modelValue:s(p),"onUpdate:modelValue":r[2]||(r[2]=t=>M(p)?p.value=t:p=t),onChange:f,disabled:s(m)},{default:a(()=>[(c(!0),b(A,null,S(s(x),t=>(c(),N(E,{key:t.id,label:t.name,value:t.id,attrName:s(g)},null,8,["label","value","attrName"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),e(R,{shadow:"always","body-style":{padding:"20px"},style:{"margin-top":"10px"}},{default:a(()=>[s(m)?U("",!0):(c(),b("div",se,[e(F,{type:"primary",size:"default",onClick:z,icon:"Plus",disabled:!s(y)},{default:a(()=>[L("添加平台属性")]),_:1},8,["disabled"]),e(W,{data:s(V),border:"",stripe:"",style:{"margin-top":"20px","margin-bottom":"20px"},"max-height":"600px"},{default:a(()=>[e(D,{label:"序号",width:"80px",align:"center",type:"index"}),e(D,{label:"属性名称",align:"center",prop:"attrName"}),e(D,{label:"属性值名称",align:"center"},{default:a(({row:t,$index:X})=>[(c(!0),b(A,null,S(t.attrValueList,O=>(c(),N(K,{key:O.id,style:{"margin-right":"5px"}},{default:a(()=>[L(Y(O.valueName),1)]),_:2},1024))),128))]),_:1}),e(D,{label:"操作",align:"center"},{default:a(({row:t,$index:X})=>[e(F,{type:"primary",size:"small",onClick:O=>z(t),icon:"Edit"},null,8,["onClick"]),e(Q,{title:`你确认删除${t.attrName}属性吗?`,onConfirm:O=>$(t),icon:"Delete",width:"200px"},{reference:a(()=>[e(F,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])])),s(m)?(c(),N(de,{key:1,attr:s(w),onCancel:v,onUpdate:q},null,8,["attr"])):U("",!0)]),_:1})],64)}}});export{ie as default};
